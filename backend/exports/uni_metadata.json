{
  "projects": [
    {
      "id": "claims_project",
      "name": "claims_project",
      "description": "claims_project dbt project",
      "path": "/Users/telvin/Desktop/dbt/dbt_project_3/claims_project"
    },
    {
      "id": "customer_project",
      "name": "customer_project",
      "description": "customer_project dbt project",
      "path": "/Users/telvin/Desktop/dbt/dbt_project_3/customer_project"
    },
    {
      "id": "policy_project",
      "name": "policy_project",
      "description": "policy_project dbt project",
      "path": "/Users/telvin/Desktop/dbt/dbt_project_3/policy_project"
    }
  ],
  "models": [
    {
      "id": "claims_project_stg_claim",
      "name": "stg_claim",
      "project": "claims_project",
      "description": "",
      "columns": [
        {
          "name": "claim_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "policy_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "claim_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "incident_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "description",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "claim_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "approved_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "status",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "adjuster_id",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'view',\n    schema = 'staging'\n  )\n}}\n\nWITH source_data AS (\n    SELECT \n        claim_id,\n        policy_id,\n        customer_id,\n        claim_date,\n        incident_date,\n        description,\n        claim_amount,\n        approved_amount,\n        status,\n        adjuster_id,\n        created_at,\n        updated_at\n    FROM {{ ref('raw_claims') }}\n)\n\nSELECT \n    claim_id,\n    policy_id,\n    customer_id,\n    claim_date,\n    incident_date,\n    description,\n    claim_amount,\n    approved_amount,\n    status,\n    adjuster_id,\n    created_at,\n    updated_at\nFROM source_data"
    },
    {
      "id": "claims_project_fct_claim",
      "name": "fct_claim",
      "project": "claims_project",
      "description": "",
      "columns": [
        {
          "name": "claim_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "policy_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "claim_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "incident_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "description",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "claim_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "approved_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "status",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "adjuster_id",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "customer_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "customer_email",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "policy_type",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "policy_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "premium_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "coverage_limit",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "deductible_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "days_to_file_claim",
          "type": "BIGINT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "approval_ratio",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "final_approved_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'table',\n    schema = 'marts'\n  )\n}}\n\nWITH stg_claim AS (\n    SELECT * FROM {{ ref('stg_claim') }}\n),\n\n-- Local reference to customer data\ncustomer_dim AS (\n    SELECT * FROM {{ ref('stg_customer') }}\n),\n\n-- Local reference to policy data\npolicy_fact AS (\n    SELECT * FROM {{ ref('stg_policy') }}\n),\n\nclaim_fact AS (\n    SELECT\n        c.claim_id,\n        c.policy_id,\n        c.customer_id,\n        c.claim_date,\n        c.incident_date,\n        c.description,\n        c.claim_amount,\n        c.approved_amount,\n        c.status,\n        c.adjuster_id,\n        \n        -- Customer information\n        cust.first_name || ' ' || cust.last_name AS customer_name,\n        cust.email AS customer_email,\n        \n        -- Policy information\n        p.policy_type,\n        p.policy_number,\n        p.premium_amount,\n        p.coverage_limit,\n        p.deductible_amount,\n        \n        -- Calculated fields\n        DATEDIFF('day', c.incident_date, c.claim_date) AS days_to_file_claim,\n        CASE \n            WHEN c.approved_amount IS NULL THEN NULL\n            ELSE c.approved_amount / NULLIF(c.claim_amount, 0) \n        END AS approval_ratio,\n        \n        CASE\n            WHEN c.approved_amount > p.coverage_limit THEN p.coverage_limit\n            ELSE c.approved_amount\n        END AS final_approved_amount,\n        \n        c.created_at,\n        c.updated_at\n    FROM stg_claim c\n    LEFT JOIN customer_dim cust ON c.customer_id = cust.customer_id\n    LEFT JOIN policy_fact p ON c.policy_id = p.policy_id\n)\n\nSELECT * FROM claim_fact"
    },
    {
      "id": "claims_project_stg_customer",
      "name": "stg_customer",
      "project": "claims_project",
      "description": "",
      "columns": [
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "first_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "last_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "email",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "phone_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "address",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "city",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "state",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "zip_code",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "date_of_birth",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "gender",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'view',\n    schema = 'staging'\n  )\n}}\n\nWITH source_data AS (\n    SELECT \n        customer_id,\n        first_name,\n        last_name,\n        email,\n        phone_number,\n        address,\n        city,\n        state,\n        zip_code,\n        date_of_birth,\n        gender,\n        created_at,\n        updated_at\n    FROM {{ ref('raw_customers') }}\n)\n\nSELECT \n    customer_id,\n    first_name,\n    last_name,\n    email,\n    phone_number,\n    address,\n    city,\n    state,\n    zip_code,\n    date_of_birth,\n    gender,\n    created_at,\n    updated_at\nFROM source_data"
    },
    {
      "id": "claims_project_dim_customer",
      "name": "dim_customer",
      "project": "claims_project",
      "description": "",
      "columns": [
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "first_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "last_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "full_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "email",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "phone_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "address",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "city",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "state",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "zip_code",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "date_of_birth",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "gender",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "age",
          "type": "BIGINT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'table',\n    schema = 'marts'\n  )\n}}\n\nWITH stg_customer AS (\n    SELECT * FROM {{ ref('stg_customer') }}\n),\n\ncustomer_dim AS (\n    SELECT\n        customer_id,\n        first_name,\n        last_name,\n        CONCAT(first_name, ' ', last_name) AS full_name,\n        email,\n        phone_number,\n        address,\n        city,\n        state,\n        zip_code,\n        date_of_birth,\n        gender,\n        EXTRACT(YEAR FROM AGE(CURRENT_DATE, date_of_birth)) AS age,\n        created_at,\n        updated_at\n    FROM stg_customer\n)\n\nSELECT * FROM customer_dim"
    },
    {
      "id": "claims_project_stg_policy",
      "name": "stg_policy",
      "project": "claims_project",
      "description": "",
      "columns": [
        {
          "name": "policy_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "policy_type",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "policy_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "premium_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "coverage_limit",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "deductible_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "effective_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "expiration_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "status",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'view',\n    schema = 'staging'\n  )\n}}\n\nWITH source_data AS (\n    SELECT \n        policy_id,\n        customer_id,\n        policy_type,\n        policy_number,\n        premium_amount,\n        coverage_limit,\n        deductible_amount,\n        effective_date,\n        expiration_date,\n        status,\n        created_at,\n        updated_at\n    FROM {{ ref('raw_policies') }}\n)\n\nSELECT \n    policy_id,\n    customer_id,\n    policy_type,\n    policy_number,\n    premium_amount,\n    coverage_limit,\n    deductible_amount,\n    effective_date,\n    expiration_date,\n    status,\n    created_at,\n    updated_at\nFROM source_data"
    },
    {
      "id": "claims_project_fct_policy",
      "name": "fct_policy",
      "project": "claims_project",
      "description": "",
      "columns": [
        {
          "name": "policy_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "policy_type",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "policy_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "premium_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "coverage_limit",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "deductible_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "effective_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "expiration_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "status",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "customer_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "customer_email",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "customer_age",
          "type": "BIGINT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "policy_duration_days",
          "type": "BIGINT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "current_status",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'table',\n    schema = 'marts'\n  )\n}}\n\nWITH stg_policy AS (\n    SELECT * FROM {{ ref('stg_policy') }}\n),\n\n-- Local reference to customer data\ncustomer_dim AS (\n    SELECT * FROM {{ ref('stg_customer') }}\n),\n\npolicy_fact AS (\n    SELECT\n        p.policy_id,\n        p.customer_id,\n        p.policy_type,\n        p.policy_number,\n        p.premium_amount,\n        p.coverage_limit,\n        p.deductible_amount,\n        p.effective_date,\n        p.expiration_date,\n        p.status,\n        c.first_name || ' ' || c.last_name AS customer_name,\n        c.email AS customer_email,\n        EXTRACT(YEAR FROM AGE(CURRENT_DATE, c.date_of_birth)) AS customer_age,\n        DATEDIFF('day', p.effective_date, p.expiration_date) AS policy_duration_days,\n        CASE \n            WHEN p.status = 'active' AND CURRENT_DATE > p.expiration_date THEN 'expired'\n            ELSE p.status\n        END AS current_status,\n        p.created_at,\n        p.updated_at\n    FROM stg_policy p\n    LEFT JOIN customer_dim c ON p.customer_id = c.customer_id\n)\n\nSELECT * FROM policy_fact"
    },
    {
      "id": "customer_project_stg_customer",
      "name": "stg_customer",
      "project": "customer_project",
      "description": "",
      "columns": [
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "first_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "last_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "email",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "phone_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "address",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "city",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "state",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "zip_code",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "date_of_birth",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "gender",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'view',\n    schema = 'staging'\n  )\n}}\n\nWITH source_data AS (\n    SELECT \n        customer_id,\n        first_name,\n        last_name,\n        email,\n        phone_number,\n        address,\n        city,\n        state,\n        zip_code,\n        date_of_birth,\n        gender,\n        created_at,\n        updated_at\n    FROM {{ ref('raw_customers') }}\n)\n\nSELECT \n    customer_id,\n    first_name,\n    last_name,\n    email,\n    phone_number,\n    address,\n    city,\n    state,\n    zip_code,\n    date_of_birth,\n    gender,\n    created_at,\n    updated_at\nFROM source_data"
    },
    {
      "id": "customer_project_dim_customer",
      "name": "dim_customer",
      "project": "customer_project",
      "description": "",
      "columns": [
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "first_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "last_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "full_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "email",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "phone_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "address",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "city",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "state",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "zip_code",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "date_of_birth",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "gender",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "age",
          "type": "BIGINT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'table',\n    schema = 'marts'\n  )\n}}\n\nWITH stg_customer AS (\n    SELECT * FROM {{ ref('stg_customer') }}\n),\n\ncustomer_dim AS (\n    SELECT\n        customer_id,\n        first_name,\n        last_name,\n        CONCAT(first_name, ' ', last_name) AS full_name,\n        email,\n        phone_number,\n        address,\n        city,\n        state,\n        zip_code,\n        date_of_birth,\n        gender,\n        EXTRACT(YEAR FROM AGE(CURRENT_DATE, date_of_birth)) AS age,\n        created_at,\n        updated_at\n    FROM stg_customer\n)\n\nSELECT * FROM customer_dim"
    },
    {
      "id": "policy_project_stg_policy",
      "name": "stg_policy",
      "project": "policy_project",
      "description": "",
      "columns": [
        {
          "name": "policy_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "policy_type",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "policy_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "premium_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "coverage_limit",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "deductible_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "effective_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "expiration_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "status",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'view',\n    schema = 'staging'\n  )\n}}\n\nWITH source_data AS (\n    SELECT \n        policy_id,\n        customer_id,\n        policy_type,\n        policy_number,\n        premium_amount,\n        coverage_limit,\n        deductible_amount,\n        effective_date,\n        expiration_date,\n        status,\n        created_at,\n        updated_at\n    FROM {{ ref('raw_policies') }}\n)\n\nSELECT \n    policy_id,\n    customer_id,\n    policy_type,\n    policy_number,\n    premium_amount,\n    coverage_limit,\n    deductible_amount,\n    effective_date,\n    expiration_date,\n    status,\n    created_at,\n    updated_at\nFROM source_data"
    },
    {
      "id": "policy_project_fct_policy",
      "name": "fct_policy",
      "project": "policy_project",
      "description": "",
      "columns": [
        {
          "name": "policy_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "policy_type",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "policy_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "premium_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "coverage_limit",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "deductible_amount",
          "type": "FLOAT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "effective_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "expiration_date",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "status",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "customer_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "customer_email",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "customer_age",
          "type": "BIGINT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "policy_duration_days",
          "type": "BIGINT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "current_status",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'table',\n    schema = 'marts'\n  )\n}}\n\nWITH stg_policy AS (\n    SELECT * FROM {{ ref('stg_policy') }}\n),\n\n-- Local reference to customer data\ncustomer_dim AS (\n    SELECT * FROM {{ ref('stg_customer') }}\n),\n\npolicy_fact AS (\n    SELECT\n        p.policy_id,\n        p.customer_id,\n        p.policy_type,\n        p.policy_number,\n        p.premium_amount,\n        p.coverage_limit,\n        p.deductible_amount,\n        p.effective_date,\n        p.expiration_date,\n        p.status,\n        c.first_name || ' ' || c.last_name AS customer_name,\n        c.email AS customer_email,\n        EXTRACT(YEAR FROM AGE(CURRENT_DATE, c.date_of_birth)) AS customer_age,\n        DATEDIFF('day', p.effective_date, p.expiration_date) AS policy_duration_days,\n        CASE \n            WHEN p.status = 'active' AND CURRENT_DATE > p.expiration_date THEN 'expired'\n            ELSE p.status\n        END AS current_status,\n        p.created_at,\n        p.updated_at\n    FROM stg_policy p\n    LEFT JOIN customer_dim c ON p.customer_id = c.customer_id\n)\n\nSELECT * FROM policy_fact"
    },
    {
      "id": "policy_project_stg_customer",
      "name": "stg_customer",
      "project": "policy_project",
      "description": "",
      "columns": [
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "first_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "last_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "email",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "phone_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "address",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "city",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "state",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "zip_code",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "date_of_birth",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "gender",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'view',\n    schema = 'staging'\n  )\n}}\n\nWITH source_data AS (\n    SELECT \n        customer_id,\n        first_name,\n        last_name,\n        email,\n        phone_number,\n        address,\n        city,\n        state,\n        zip_code,\n        date_of_birth,\n        gender,\n        created_at,\n        updated_at\n    FROM {{ ref('raw_customers') }}\n)\n\nSELECT \n    customer_id,\n    first_name,\n    last_name,\n    email,\n    phone_number,\n    address,\n    city,\n    state,\n    zip_code,\n    date_of_birth,\n    gender,\n    created_at,\n    updated_at\nFROM source_data"
    },
    {
      "id": "policy_project_dim_customer",
      "name": "dim_customer",
      "project": "policy_project",
      "description": "",
      "columns": [
        {
          "name": "customer_id",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": true
        },
        {
          "name": "first_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "last_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "full_name",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "email",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "phone_number",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "address",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "city",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "state",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "zip_code",
          "type": "INTEGER",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "date_of_birth",
          "type": "DATE",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "gender",
          "type": "VARCHAR",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "age",
          "type": "BIGINT",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "description": "",
          "isPrimaryKey": false,
          "isForeignKey": false
        }
      ],
      "sql": "{{\n  config(\n    materialized = 'table',\n    schema = 'marts'\n  )\n}}\n\nWITH stg_customer AS (\n    SELECT * FROM {{ ref('stg_customer') }}\n),\n\ncustomer_dim AS (\n    SELECT\n        customer_id,\n        first_name,\n        last_name,\n        CONCAT(first_name, ' ', last_name) AS full_name,\n        email,\n        phone_number,\n        address,\n        city,\n        state,\n        zip_code,\n        date_of_birth,\n        gender,\n        EXTRACT(YEAR FROM AGE(CURRENT_DATE, date_of_birth)) AS age,\n        created_at,\n        updated_at\n    FROM stg_customer\n)\n\nSELECT * FROM customer_dim"
    }
  ],
  "lineage": [
    {
      "source": "claims_project_stg_claim",
      "target": "claims_project_fct_claim"
    },
    {
      "source": "claims_project_stg_customer",
      "target": "claims_project_fct_claim"
    },
    {
      "source": "claims_project_stg_policy",
      "target": "claims_project_fct_claim"
    },
    {
      "source": "claims_project_stg_customer",
      "target": "claims_project_dim_customer"
    },
    {
      "source": "claims_project_stg_policy",
      "target": "claims_project_fct_policy"
    },
    {
      "source": "claims_project_stg_customer",
      "target": "claims_project_fct_policy"
    },
    {
      "source": "customer_project_stg_customer",
      "target": "customer_project_dim_customer"
    },
    {
      "source": "policy_project_stg_policy",
      "target": "policy_project_fct_policy"
    },
    {
      "source": "policy_project_stg_customer",
      "target": "policy_project_fct_policy"
    },
    {
      "source": "policy_project_stg_customer",
      "target": "policy_project_dim_customer"
    }
  ]
}